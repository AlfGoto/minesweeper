"use strict";var i=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var S=Object.prototype.hasOwnProperty;var f=(t,e)=>{for(var o in e)i(t,o,{get:e[o],enumerable:!0})},O=(t,e,o,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of g(e))!S.call(t,s)&&s!==o&&i(t,s,{get:()=>e[s],enumerable:!(r=u(e,s))||r.enumerable});return t};var A=t=>O(i({},"__esModule",{value:!0}),t);var b={};f(b,{handler:()=>P});module.exports=A(b);var c=require("@aws-sdk/client-dynamodb"),n=require("@aws-sdk/lib-dynamodb"),C=new c.DynamoDBClient({}),w=n.DynamoDBDocumentClient.from(C),I=process.env.TABLE_NAME,P=async t=>{console.log("Event received:",JSON.stringify(t,null,2));let e={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization"};if(t.httpMethod==="OPTIONS")return{statusCode:200,headers:e,body:JSON.stringify({message:"CORS enabled"})};try{if(!t.body)return{statusCode:400,headers:e,body:JSON.stringify({message:"Request body is required"})};let o=JSON.parse(t.body);console.log("Request body:",o);let{userId:r,status:s,time:m,successTime:l,winTime:d}=o;if(!r||!s)return{statusCode:400,headers:e,body:JSON.stringify({message:"userId and status are required"})};let y=new Date().toISOString(),a={userId:r,timestamp:y,status:s,time:m||l||d||0,date:new Date().toISOString()};return console.log("Storing item:",a),await w.send(new n.PutCommand({TableName:I,Item:a})),console.log("Item stored successfully"),{statusCode:200,headers:e,body:JSON.stringify({message:"Game result stored successfully",item:a})}}catch(o){return console.error("Error:",o),{statusCode:500,headers:e,body:JSON.stringify({message:"Internal server error",error:o instanceof Error?o.message:String(o)})}}};0&&(module.exports={handler});
