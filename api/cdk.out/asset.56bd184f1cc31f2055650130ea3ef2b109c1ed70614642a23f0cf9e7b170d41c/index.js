"use strict";var a=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var S=(t,e)=>{for(var s in e)a(t,s,{get:e[s],enumerable:!0})},O=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of u(e))!g.call(t,o)&&o!==s&&a(t,o,{get:()=>e[o],enumerable:!(r=m(e,o))||r.enumerable});return t};var A=t=>O(a({},"__esModule",{value:!0}),t);var b={};S(b,{handler:()=>I});module.exports=A(b);var i=require("aws-sdk"),f=new i.DynamoDB.DocumentClient,p=process.env.TABLE_NAME,I=async t=>{console.log("Event received:",JSON.stringify(t,null,2));let e={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type,Authorization"};if(t.httpMethod==="OPTIONS")return{statusCode:200,headers:e,body:JSON.stringify({message:"CORS enabled"})};try{if(!t.body)return{statusCode:400,headers:e,body:JSON.stringify({message:"Request body is required"})};let s=JSON.parse(t.body);console.log("Request body:",s);let{userId:r,status:o,time:c,successTime:l,winTime:y}=s;if(!r||!o)return{statusCode:400,headers:e,body:JSON.stringify({message:"userId and status are required"})};let d=new Date().toISOString(),n={userId:r,timestamp:d,status:o,time:c||l||y||0,date:new Date().toISOString()};return console.log("Storing item:",n),await f.put({TableName:p,Item:n}).promise(),console.log("Item stored successfully"),{statusCode:200,headers:e,body:JSON.stringify({message:"Game result stored successfully",item:n})}}catch(s){return console.error("Error:",s),{statusCode:500,headers:e,body:JSON.stringify({message:"Internal server error",error:s instanceof Error?s.message:String(s)})}}};0&&(module.exports={handler});
